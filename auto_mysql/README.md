mysql相关的一些自动化脚本;

## 一、需求分析

主要想实现快速创建MySQL实例, 因为如果按照官方文档来安装也是需要分为几个步骤:

1. 下载对应的版本二进制安装包, 解压缩到 /usr/local目录下, 通常是这个目录
2. 初始化数据目录;
3. 启动mysqld服务, 修改初始密码;
4. 可能还需要安装默认未支持的存储引擎插件, 建库建表等等...

想直接使用一个python脚本自动化该过程; 自动化后有以下好处:

* 如果是一台机器安装多个实例(通常是测试环境), 这些重复步骤可以交给python脚本完成
* 如果安装的多实例MySQL版本不同, 脚本自动化不容易出错;

### 1.1 后期考虑

兼容windows? 没试过通过脚本在windows上创建mysql实例;

## 二、功能接口

### 2.1 create_mysql_instance

作用: 创建一个MySQL实例, 需要用户传入MySQL的基本安装路径, 并且指定端口号;

是否留一个参数让用户可以指定 数据目录? 而不是直接根据端口号设置数据目录。或者考虑不需要用户指定数据目录了, 直接在Linux系统上创建一个新用户mysql, 将所有数据放到`/home/mysql`目录下;

1. 预先做一些检查, 比如说MySQL安装路径是否正确, 端口号是否可用? 数据目录是否已经创建过...
2. 配置文件中会预先设置一些内容...**注意MGR节点的IP配置, 是会影响到节点之间数据同步的**

### 2.2 create_mariadb_instance

作用: 创建一个MariaDB实例, 需要用户传入MySQL的基本安装路径, 并且指定端口号;

1. 会预先做一些检查, 比如说MySQL是否已安装, 端口号是否可用?

### 2.3 create_mgr_instance

作用: 通过调用mysqlsh(用户机器上必须已经安装mysqlsh, 否则无法执行), 创建一个MGR实例; MySQL节点数量可变, 取决于用户传入多少个可用MySQL节点... 直接限定死, 至少3个吧

### 2.4 自动下载MariaDB

当前如果MariaDB未安装，将无法创建实例。

https://mariadb.org/downloads-rest-api/

MariaDB官方提供了rest-api支持下载MariaDB二进制包。这可太棒了，这样我们就可以直接集成到我们的脚本中。

实现MariaDb的自动下载，安装，创建实例。

## 问题

MySQL和MariaDB官方的二进制包下载下来, 安装在`/usr/local/`之后, 所属用户, 组并不是root, 而是奇怪的用户ID; 可能会导致一些问题, 需要自行修改下所属用户和组; 

这个也可以交由auto_mysql脚本完成?

## 设计

要不要面向对象? 比如说mariadb, mysql都继承一个 db类

然后在各自提供 创建实例, 启动实例, 关闭实例 等操作;

还是算了, 用不到继承, 用不到多态, 没啥必要;
