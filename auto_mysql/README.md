# auto_mysql

主要提供mysql相关的一些自动化脚本。

## 一、需求分析

最初的需求是为了实现快速创建MySQL实例，因为按照官方文档来创建一个MySQL实例需要分为几个步骤:

1. 下载对应的版本二进制安装包，解压缩到/usr/local目录下，通常是这个目录
2. 初始化数据目录。
3. 启动mysqld服务，修改初始密码。
4. 可能还需要安装默认未支持的存储引擎插件，建库建表等等...

其中最麻烦的就是初始化数据目录，**不同版本的mysql甚至初始化数据目录的方式不同**。

想直接使用一个python脚本自动化该过程; 自动化后有以下好处:

* 如果是一台机器安装多个实例(通常是测试环境)，重复步骤可以交给python脚本完成，更省事。
* 如果安装的多实例MySQL版本不同，脚本自动化更快，更准确。
* 只需要稍微修改下 define.py 文件中的变量定义，指定好**安装目录，数据目录，网卡名称**，剩下内容都可以全自动。

## 二、功能接口

目前支持MySQL5，MySQL8和Mariadb的实例创建。

### 2.1 实现的class

提供了MySQL5，MySQL8，MariaDB这几个class，用于实现对应版本的实例创建。比如说初始化数据目录，启动实例，关闭实例。

### 2.2 自动创建主从复制

通过脚本可以很快创建两个实例，并且脚本实现自动创建两个实例之间的主从复制通道。

### 2.3 自动下载MariaDB

目前还未实现

当前如果MariaDB未安装，将无法创建实例。

该链接：<https://mariadb.org/downloads-rest-api/>，MariaDB官方提供了rest-api支持下载MariaDB二进制包。这可太棒了，这样我们就可以直接集成到我们的脚本中。

实现MariaDb包的自动下载，安装。

## 三、后续功能

1. 是否要兼容windows？没试过通过脚本在windows上创建mysql实例。这工作量比较大，且windows上用的不多。
2. 自动通过mysql官网，下载MySQL和MariaDB官方二进制包？自动安装解压到`/usr/local/`之后，不过这需要root权限，还需要修改安装目录所属用户，组。解压完默认是个奇怪的账号。
